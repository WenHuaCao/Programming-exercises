# Day11 异世界六部曲（二）罗姆的常系数齐次线性递推

### 背景故事

*出题人遇到了被偷了徽章的艾米莉亚，他们一起寻找徽章，最后锁定在一家赃物店里，却没有想到，两人相继进店，相继被杀。*

*出题人发现自己拥有死亡回归的能力，读档复活了。出题人又遇见了艾米莉亚，然而艾米莉亚却一副不认识出题人的样子，出题人一脸茫然。*

*不知所措的出题人决定先去店里赎回徽章。来到店里，这里只有罗姆老爷爷，和一个小女孩。*

*罗姆：“你拿什么来赎？”*

### 题目描述

出题人：“当当当当！看这个手机，它有很神奇的能力，它能算递推数列哦！”

罗姆：“递推数列？这个老夫也会，老夫识得斐波那契数列，就是 $f _ 1=1,~f _ 2=1,~f _ n=f _ {n-1}+f _ {n-2}$，这个数列是 $1,1,2,3,5,8,13\cdots$”

出题人：“很好。常系数齐次线性递推就是一种扩展，定义 $f _ 1=a _ 1,~f _ 2=a _ 2,\cdots,f _ k=a _ k$，当 $n>k$ 时，有 $f _ n=c _ 1f _ {n-1}+c _ 2f _ {n-2}+\cdots+c _ kf _ {n-k}$。

“比如，令 $k=2,~a _ 1=a _ 2=c _ 1=c _ 2=1$，那么它就成了斐波那契数列。

“现在给你 $a _ 1,\cdots,a _ k$ 这 $k$ 个初始项、$c _ 1,\cdots,c _ k$ 这 $k$ 个递推系数，以及 $n$，你能求出 $f _ n$ 吗？注意 $n$ 很大哟~你不会了吧~”

罗姆：“这。。老夫还真不会，你这破盒子就能算对了？”

你作为出题人手机这个程序的编写者，是时候向罗姆爷展现你的能力了！

由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模。易证，对于乘法运算：$(a\times b) \bmod p=((a \bmod p) \times (b \bmod p)) \bmod p$，对于加法运算：$(a+b) \bmod p=((a \bmod p)+(b \bmod p))\bmod p$。即，对于你的程序中跟答案直接相关的加法和乘法运算，每次运算完之后都对 $10^9+7$ 取模，这样就不会溢出 long long 了。

**本题附有提示，但在阅读提示前请务必进行充分的独立思考，否则对你的学习能力提升没有意义。**

### 输入格式

第一行两个正整数 $k,n$。（$1 \leq k \leq 20$，$k \leq n \leq 10^{18}$）

第二行 $k$ 个整数，表示 $a _ 1,\cdots,a _ k$。

第三行 $k$ 个整数，表示 $c _ 1,\cdots,c _ k$。（$1 \leq a _ i,c _ i \leq 10^9$）

### 输出格式

一行，一个整数，表示 $f _ n$ 对 $10^9+7$ 取模。

### 样例输入1

2 6

1 1

1 1

### 样例输出1

8

### 样例输入2

3 6

1 2 3

3 2 1

### 样例输出2

181

### 提示1

聪明的你一定学过线性代数，我们来简单应用一下。

考虑斐波那契数列 $ f _ n=f _ {n-1}+f _ {n-2} $，我们构造一个向量 $\vec v=\begin{bmatrix}f _ {n-1} \newline f _ {n-2}\end{bmatrix}$，把它乘一个矩阵 $A=\begin{bmatrix}1&1 \newline 1&0\end{bmatrix}$，会得到什么呢？
$$
A\vec v=\begin{bmatrix}1&1 \newline 1&0\end{bmatrix}\begin{bmatrix}f _ {n-1} \newline f _ {n-2}\end{bmatrix}=\begin{bmatrix}f _ {n-1}+f _ {n-2} \newline f _ {n-1}\end{bmatrix}=\begin{bmatrix}f _ n \newline f _ {n-1}\end{bmatrix}
$$

会发现 $f$ 的下标往前推进了一位！这就产生了递推！

聪明的你一定想到了扩展到常系数齐次线性递推要怎么做。

### 提示2

给定 $x,y$，而 $y$ 很大，要怎么求 $x^y$ 呢？

如果 $y$ 是偶数，你可以先求 $x^{\frac y2}$，然后给它平方一下；

如果 $y$ 是奇数，你可以先求 $x^{\frac{y-1}{2}}$，然后给它平方一下，然后再乘个 $x$。

聪明的你一定知道这样做的时间复杂度是多少。

### 提示3

离散课本里好像还给出了一种直接解特征方程的方法呢！哪个方法比较好呢？课本里的方法能不能用在这个题里呢？两种方法有什么联系呢？能不能互相推导出来呢？

聪明的你一定被激发了学习的热情！

